<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: splice-chars.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: splice-chars.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const { collectTextNodes, createTextNode } = require('./helpers');

/**
 * removes characters from an element, optionally inserting
 * one or more replacements
 *
 * @param   {HTMLElement}  $el
 * @param   {number}  startIndex  character-index at which to start the splice
 * @param   {number}  deleteCount  integer counting chars to delete starting at startIndex
 * @param   {HTMLElement}  ...insertions  elements to insert at startIndex (if any)
 *
 * @return  {HTMLElement}  returns the input element
 */
function spliceChars($el, startIndex, deleteCount, ...insertions) {
  let endIndex = startIndex + deleteCount;
  let textNodes = [ ...collectTextNodes($el) ];

  for (let nodeIdx = 0, charIdx = 0; nodeIdx &lt; textNodes.length &amp;&amp; charIdx &lt;= endIndex; nodeIdx++) {
    let $node = textNodes[nodeIdx];
    let nodeText = $node.textContent;
    if (charIdx &lt;= endIndex &amp;&amp; startIndex &lt; charIdx + nodeText.length) {
      // copy any text following the end of the deletion range
      let trailingText = nodeText.slice(startIndex - charIdx + deleteCount);
      if (trailingText) {
        // insert the trailing text
        $node.after(createTextNode(trailingText));
      }

      // insert insertions in front of the trailingText
      while (insertions.length) {
        $node.after(insertions.pop());
      }

      // copy any text preceding the beginning of the deletion range
      let leadingText = nodeText.slice(0, startIndex - charIdx);
      if (leadingText &amp;&amp; startIndex - charIdx > 0) {
        // insert the leading range
        $node.after(createTextNode(leadingText));
      }

      // remove the original text node
      let $parent = $node.parentNode;
      $node.remove();
      // remove empty parent elements (if any)
      while (!$parent.innerHTML &amp;&amp; !$parent.isSameNode($el)) {
        let $grandparent = $parent.parentNode;
        $parent.remove();
        $parent = $grandparent;
      }
    }
    charIdx += nodeText.length;
  }
  return $el;
}

module.exports = { spliceChars };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#closest">closest</a></li><li><a href="global.html#collectTextNodes">collectTextNodes</a></li><li><a href="global.html#createElement">createElement</a></li><li><a href="global.html#createFragment">createFragment</a></li><li><a href="global.html#createTextNode">createTextNode</a></li><li><a href="global.html#fragmentToHtml">fragmentToHtml</a></li><li><a href="global.html#parentsUntil">parentsUntil</a></li><li><a href="global.html#spliceChars">spliceChars</a></li><li><a href="global.html#unwrap">unwrap</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Mon Nov 11 2019 11:42:10 GMT-0800 (Pacific Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
